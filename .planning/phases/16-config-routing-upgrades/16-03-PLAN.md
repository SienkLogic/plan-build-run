---
phase: "16-config-routing-upgrades"
plan: "16-03"
type: "feature"
wave: 1
depends_on: []
files_modified:
  - "plugins/dev/skills/quick/SKILL.md"
autonomous: true
dependency_fingerprints:
  "15-01": "len:4037-mod:2026-02-10T20:26"
  "15-02": "len:4079-mod:2026-02-10T20:26"
discovery: 0
must_haves:
  truths:
    - "/dev:quick scope confirmation uses proper AskUserQuestion structure"
    - "Freeform prompts in /dev:quick remain as plain text (task description, clarifying questions)"
    - "All existing tests pass after all Phase 16 changes"
  artifacts:
    - "plugins/dev/skills/quick/SKILL.md (scope confirmation converted, freeform inputs preserved)"
  key_links:
    - "quick SKILL.md references scope-confirm pattern from gate-prompts.md"
    - "quick SKILL.md freeform inputs (lines 50, 268-273) remain as plain text conversation"
---

# Plan 16-03: Convert Quick Skill + Phase Verification

## Goal

Convert the quick skill's scope validation prompt to proper AskUserQuestion structure, fix existing freeform-input references that incorrectly mention AskUserQuestion, and verify all Phase 16 changes pass existing tests.

## Context

The quick skill already mentions AskUserQuestion in three places, but only one is appropriate for conversion (scope validation at line 72). The other two (task description input at line 50, clarifying questions at lines 268-273) ask for freeform text -- AskUserQuestion is for structured option selection, not text input. These must be corrected to use plain text prompts.

The continue skill requires zero changes -- research confirmed it is fully automated with no user-facing menus ("Do, don't ask"). Success criteria #4 ("when ambiguous") does not apply since the skill has no ambiguous states.

---

<task id="16-03-T1" type="auto" tdd="false">
  <name>Convert quick SKILL.md scope confirmation and fix freeform references</name>
  <files>
    plugins/dev/skills/quick/SKILL.md
  </files>
  <action>
1. Read `plugins/dev/skills/quick/SKILL.md` to confirm current content
2. In the `allowed-tools` frontmatter, add `AskUserQuestion` to the list. Change from `Read, Write, Edit, Bash, Glob, Grep, Task` to `Read, Write, Edit, Bash, Glob, Grep, Task, AskUserQuestion`

**Conversion Point 1: Scope validation (lines 60-72)**

3. Replace the scope validation section (lines 60-72). The current text reads:

```
Then warn the user:
```
This looks like it might be bigger than a quick task. Quick tasks work best for:
- Bug fixes
- Small feature additions
- Configuration changes
- Refactoring a single module
- Adding a test

Would you like to proceed as a quick task, or use `/dev:plan` for a full planning cycle?
```

Use AskUserQuestion to let the user decide. If they want to proceed, continue.
```

Replace with:

```
Then use the **scope-confirm** pattern (see `skills/shared/gate-prompts.md`):

Use AskUserQuestion:
  question: "This task looks complex. Quick tasks work best for bug fixes, small features, config changes, and single-module refactors. How would you like to proceed?"
  header: "Scope"
  options:
    - label: "Quick task"  description: "Execute as lightweight task"
    - label: "Full plan"   description: "Switch to /dev:plan for proper planning"
    - label: "Revise"      description: "Let me rewrite the task description"
  multiSelect: false

If user selects "Quick task": continue to Step 4.
If user selects "Full plan": respond "Use `/dev:plan` to create a full planning cycle for this task." and stop.
If user selects "Revise": go back to Step 2 to get a new task description.
If user types something else (freeform): interpret their response and proceed accordingly.
```

**Fix 1: Task description input (line 50)**

4. Replace line 50. The current text reads:
```
- Ask user via AskUserQuestion: "What do you need done? Describe the task in a sentence or two."
```

Replace with:
```
- Ask the user: "What do you need done? Describe the task in a sentence or two."
  This is a freeform text prompt — do NOT use AskUserQuestion here. Task descriptions require arbitrary text input, not option selection.
```

**Fix 2: Clarifying questions (lines 268-273)**

5. Replace the clarifying questions section (lines 268-273). The current text reads:
```
### Task description is too vague
- Ask clarifying questions via AskUserQuestion:
  - "Which file(s) need to change?"
  - "What should the end result look like?"
  - "Is there a specific error to fix?"
```

Replace with:
```
### Task description is too vague
- Ask clarifying questions as plain text prompts (do NOT use AskUserQuestion — these require freeform text answers):
  - "Which file(s) need to change?"
  - "What should the end result look like?"
  - "Is there a specific error to fix?"
```

6. Keep all other sections (Steps 4-11, Quick Task Plan Generation, other Edge Cases, Anti-Patterns) unchanged
  </action>
  <verify>
node -e "const fs = require('fs'); const c = fs.readFileSync('plugins/dev/skills/quick/SKILL.md', 'utf8'); const fm = c.split('---')[1]; console.log('Has AskUserQuestion in tools:', fm.includes('AskUserQuestion')); console.log('Has scope-confirm ref:', c.includes('scope-confirm')); console.log('Freeform task desc fixed:', c.includes('do NOT use AskUserQuestion here')); console.log('Freeform clarifying fixed:', c.includes('do NOT use AskUserQuestion') && c.includes('freeform text answers')); console.log('No old warn block:', !c.includes('Would you like to proceed as a quick task'));"
  </verify>
  <done>/dev:quick scope confirmation uses proper AskUserQuestion with scope-confirm pattern; freeform prompts (task description, clarifying questions) explicitly marked as plain text, not AskUserQuestion</done>
</task>

<task id="16-03-T2" type="auto" tdd="false">
  <name>Run full test suite to verify no regressions</name>
  <files>
  </files>
  <action>
1. Run the full test suite: `npm test`
2. Verify all tests pass (expect 335+ tests, 23+ suites)
3. If any tests fail, investigate whether the failure is related to Phase 16 changes:
   - SKILL.md format changes should not affect tests (tests check hook scripts, not skill content)
   - gate-prompts.md changes should not affect tests (it's a reference doc, not executable code)
   - If failures are unrelated to Phase 16, note them but do not attempt fixes
4. Run the plugin validation: `npm run validate`
5. Verify all skills still have valid frontmatter (name, description, allowed-tools fields present)

This task produces no file changes — it is verification-only.
  </action>
  <verify>
npm test 2>&1 | tail -5
npm run validate 2>&1 | tail -3
  </verify>
  <done>All existing tests pass after Phase 16 changes; plugin validation succeeds for all skills</done>
</task>
