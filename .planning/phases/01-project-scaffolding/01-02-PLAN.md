---
phase: "01-project-scaffolding"
plan: "01-02"
type: "feature"
wave: 2
depends_on: ["01-01"]
files_modified:
  - "src/views/layout.ejs"
  - "src/views/index.ejs"
  - "src/views/error.ejs"
  - "src/views/partials/head.ejs"
  - "src/views/partials/header.ejs"
  - "src/views/partials/footer.ejs"
  - "public/.gitkeep"
autonomous: true
discovery: 0
must_haves:
  truths:
    - "GET / returns HTTP 200 with an HTML page containing 'Towline Dashboard'"
    - "The HTML page includes Pico.css from CDN for semantic styling"
    - "All pages share a common layout via EJS <%- include() %> partials"
    - "Static files in public/ are served by Express"
    - "Error pages render a user-friendly HTML page, not raw JSON"
  artifacts:
    - "src/views/layout.ejs wrapping all pages with head, header, content area, footer"
    - "src/views/index.ejs rendering the placeholder homepage"
    - "src/views/error.ejs rendering error messages"
    - "src/views/partials/head.ejs with meta tags and Pico.css CDN link"
    - "src/views/partials/header.ejs with site navigation header"
    - "src/views/partials/footer.ejs with footer content"
    - "public/.gitkeep ensuring the public directory exists in version control"
  key_links:
    - "index.ejs and error.ejs both include layout.ejs partials for consistent structure"
    - "head.ejs loads Pico.css from CDN -- no local CSS build step"
    - "index.routes.js renders index.ejs with data from project.service.js"
    - "errorHandler.js renders error.ejs on unhandled errors"
provides:
  - "EJS layout system with <%- include() %> partials"
  - "Pico.css styling via CDN"
  - "Placeholder homepage at GET /"
  - "Error page template"
consumes:
  - "createApp() with view engine configured (from plan 01-01)"
  - "indexRouter rendering 'index' template (from plan 01-01)"
  - "errorHandler rendering 'error' template (from plan 01-01)"
---

# Plan 01-02: EJS Templates, Pico.css Integration, and Placeholder Page

## Overview

Create the EJS view layer that Plan 01-01's Express app renders. This includes
a layout system using `<%- include() %>` partials (no ejs-mate dependency),
Pico.css loaded from CDN for zero-build styling, a placeholder homepage, and
an error page. After this plan, `node bin/cli.js --dir .` serves a fully styled
placeholder page at http://127.0.0.1:3000.

## Tasks

<task id="01-02-T1" type="auto">
  <name>Create EJS layout partials and page templates</name>
  <files>
    src/views/partials/head.ejs
    src/views/partials/header.ejs
    src/views/partials/footer.ejs
    src/views/layout.ejs
    src/views/index.ejs
    src/views/error.ejs
    public/.gitkeep
  </files>
  <action>
    All file paths are relative to `D:\Repos\towline-test-project`.

    1. Create `public/.gitkeep` -- empty file to ensure the public/ directory
       is tracked by git. Express static middleware serves from this directory.

    2. Create `src/views/partials/head.ejs` -- shared HTML head:
       ```html
       <head>
         <meta charset="UTF-8">
         <meta name="viewport" content="width=device-width, initial-scale=1.0">
         <title><%= typeof title !== 'undefined' ? title : 'Towline' %> - Towline</title>
         <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
       </head>
       ```

       Key points:
       - Pico.css v2 from jsDelivr CDN -- no local files, no build step
       - Defensive `typeof title` check prevents undefined errors if title is not passed
       - NO HTMX or Alpine.js yet -- those are added in Phase 11 when actually needed

    3. Create `src/views/partials/header.ejs` -- site header:
       ```html
       <header class="container">
         <nav>
           <ul>
             <li><strong>Towline Dashboard</strong></li>
           </ul>
           <ul>
             <li><a href="/">Dashboard</a></li>
           </ul>
         </nav>
       </header>
       ```

       Key points:
       - Uses Pico.css semantic nav styling
       - Minimal nav for Phase 1 -- future phases add Phases, Todos, Roadmap links

    4. Create `src/views/partials/footer.ejs` -- site footer:
       ```html
       <footer class="container">
         <small>Towline Dashboard v0.1.0</small>
       </footer>
       ```

    5. Create `src/views/layout.ejs` -- a reusable layout wrapper that other
       templates include via a documented pattern. NOTE: EJS does not support
       layout inheritance natively. Instead, each page template includes the
       partials directly. This file exists as documentation of the layout
       structure and as a reference. The actual pattern is:
       - Each page template (index.ejs, error.ejs) is a COMPLETE HTML document
       - Each page template includes head.ejs, header.ejs, and footer.ejs partials
       - This keeps the layout consistent without needing ejs-mate

       Content for `layout.ejs`:
       ```html
       <%#
         Layout Reference
         ================
         This file documents the standard page structure.
         Each page template should follow this pattern:

         <!DOCTYPE html>
         <html lang="en">
         <%- include('partials/head', { title: 'Page Title' }) %>
         <body>
           <%- include('partials/header') %>
           <main class="container">
             <!-- Page-specific content here -->
           </main>
           <%- include('partials/footer') %>
         </body>
         </html>
       %>
       ```

    6. Create `src/views/index.ejs` -- the placeholder homepage:
       ```html
       <!DOCTYPE html>
       <html lang="en">
       <%- include('partials/head', { title: title }) %>
       <body>
         <%- include('partials/header') %>
         <main class="container">
           <h1><%= title %></h1>
           <p><%= message %></p>

           <section>
             <h2>Project Configuration</h2>
             <table>
               <tbody>
                 <tr>
                   <td><strong>Project Directory</strong></td>
                   <td><code><%= projectDir %></code></td>
                 </tr>
                 <tr>
                   <td><strong>Status</strong></td>
                   <td>Server running</td>
                 </tr>
               </tbody>
             </table>
           </section>
         </main>
         <%- include('partials/footer') %>
       </body>
       </html>
       ```

       Key points:
       - Complete HTML document including all partials
       - Uses Pico.css semantic elements: table, code, section, main.container
       - Displays `title`, `message`, and `projectDir` from the service layer
       - No custom CSS classes -- Pico.css styles semantic HTML automatically

    7. Create `src/views/error.ejs` -- the error page:
       ```html
       <!DOCTYPE html>
       <html lang="en">
       <%- include('partials/head', { title: 'Error' }) %>
       <body>
         <%- include('partials/header') %>
         <main class="container">
           <h1>Error <%= status %></h1>
           <p><%= message %></p>
           <p><a href="/">Return to Dashboard</a></p>
         </main>
         <%- include('partials/footer') %>
       </body>
       </html>
       ```

       Key points:
       - Renders the status code and error message
       - Provides a link back to the dashboard
       - Uses same layout partials as all other pages
  </action>
  <verify>
    cd /d D:\Repos\towline-test-project && dir /s /b src\views\*.ejs && dir /s /b src\views\partials\*.ejs && dir public\.gitkeep
  </verify>
  <done>All six EJS template files exist and the public directory is tracked</done>
</task>

<task id="01-02-T2" type="auto">
  <name>Verify server starts and serves the placeholder page</name>
  <files>
    bin/cli.js
  </files>
  <action>
    This is a verification-only task. No files are modified.

    1. Start the server in the background:
       ```
       cd D:\Repos\towline-test-project
       node bin/cli.js --dir . --port 3456
       ```
       (Use port 3456 to avoid conflicts with anything on 3000)

    2. In a separate process, make an HTTP request to verify the response:
       ```
       curl -s http://127.0.0.1:3456/
       ```

    3. Verify the response:
       - HTTP status is 200
       - Response body contains "Towline Dashboard"
       - Response body contains "Pico.css" (CDN link is present)
       - Response body contains "Project Directory" (config table)

    4. Stop the server (Ctrl+C or kill the process).

    5. Verify CLI flag parsing by testing `--port` and `--dir`:
       ```
       node bin/cli.js --help
       ```
       Confirm help text shows -d/--dir and -p/--port options.
  </action>
  <verify>
    cd /d D:\Repos\towline-test-project && node -e "import('./src/app.js').then(async m => { const app = m.createApp({projectDir: '.'}); const server = app.listen(3456, '127.0.0.1', async () => { try { const res = await fetch('http://127.0.0.1:3456/'); const body = await res.text(); if (res.status !== 200) throw new Error('status ' + res.status); if (!body.includes('Towline Dashboard')) throw new Error('missing title'); if (!body.includes('cdn.jsdelivr.net/npm/@picocss/pico')) throw new Error('missing Pico.css CDN'); console.log('PASS: status 200, title present, Pico.css CDN present'); } finally { server.close() } }) })"
  </verify>
  <done>Server starts on the configured port, GET / returns HTTP 200 with an HTML page containing "Towline Dashboard" styled with Pico.css, and the --dir flag value is displayed on the page</done>
</task>
