<%- include('breadcrumbs', { breadcrumbs: typeof breadcrumbs !== 'undefined' ? breadcrumbs : [] }) %>
<h1>Notes</h1>

<% if (notes.length === 0) { %>
<%- include('empty-state', { icon: 'N', title: 'No notes yet', action: 'Use /pbr:note to create project notes.' }) %>
<% } else { %>
<% notes.forEach(function(note) { %>
<% const noteSlug = note.filename.replace(/^\d{4}-\d{2}-\d{2}-/, '').replace(/\.md$/, ''); %>
<div class="card mb-2">
  <div class="card-header">
    <strong>
      <a href="/notes/<%= noteSlug %>"
         hx-get="/notes/<%= noteSlug %>"
         hx-target="#main-content"
         hx-push-url="true"><%= note.title %></a>
    </strong>
    <span style="display:flex;gap:var(--space-sm);align-items:center;margin-left:auto">
      <% if (note.promoted) { %>
        <span class="status-badge status-badge--sm" data-status="complete">promoted</span>
      <% } %>
      <% if (note.date) { %>
        <small style="color:var(--color-text-dim)"><%= typeof note.date === 'object' ? note.date.toISOString().slice(0, 10) : String(note.date).slice(0, 10) %></small>
      <% } %>
    </span>
  </div>
</div>
<% }); %>
<% } %>
