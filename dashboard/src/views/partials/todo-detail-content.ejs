<%- include('breadcrumbs', { breadcrumbs: typeof breadcrumbs !== 'undefined' ? breadcrumbs : [] }) %>
<h1><%= title %></h1>

<p><a href="/todos">&larr; Back to Todos</a></p>

<div class="card mb-3">
  <div class="card-header">
    <strong>Todo <%= id %></strong>
    &nbsp;
    <span class="status-badge" data-priority="<%= priority %>">
      <%= priority %>
    </span>
    &nbsp;
    <span class="status-badge" data-status="<%= status %>">
      <%= status %>
    </span>
  </div>
  <div class="card-body">
    <% if (phase) { %>
    <p><strong>Phase:</strong> <%= phase %></p>
    <% } %>
    <% if (created) { %>
    <p><strong>Created:</strong> <%= created %></p>
    <% } %>

    <hr>

    <%- html %>

    <% if (status === 'pending') { %>
    <hr>
    <form method="POST" action="/todos/<%= id %>/done"
          hx-post="/todos/<%= id %>/done"
          hx-target="closest .card"
          hx-swap="outerHTML"
          hx-indicator="#done-spinner"
          style="display:inline;">
      <button type="submit" class="btn btn-outline-secondary">Mark as Done</button>
      <span id="done-spinner" class="spinner-border spinner-border-sm htmx-indicator" role="status"></span>
    </form>
    <% } %>
  </div>
</div>
