<%- include('breadcrumbs', { breadcrumbs: typeof breadcrumbs !== 'undefined' ? breadcrumbs : [] }) %>
<h1>Research</h1>

<h2>Research Documents</h2>
<% if (researchDocs.length === 0) { %>
<%- include('empty-state', { icon: 'R', title: 'No research documents', action: 'Run /pbr:explore or /pbr:scan to generate research.' }) %>
<% } else { %>
<% researchDocs.forEach(function(doc) { %>
<div class="card mb-2">
  <div class="card-header">
    <strong>
      <a href="/research/<%= doc.slug %>"
         hx-get="/research/<%= doc.slug %>"
         hx-target="#main-content"
         hx-push-url="true"><%= doc.title %></a>
    </strong>
    <% if (doc.date) { %><small class="ms-auto text-muted"><%= doc.date %></small><% } %>
  </div>
  <div class="card-body">
    <% if (doc.topic) { %><p><strong>Topic:</strong> <%= doc.topic %></p><% } %>
    <% if (doc.confidence || doc.coverage) { %>
    <p>
      <% if (doc.confidence) { %><span class="status-badge" data-status="<%= doc.confidence %>"><%= doc.confidence %></span>&nbsp;<% } %>
      <% if (doc.coverage) { %><small>Coverage: <%= doc.coverage %></small><% } %>
    </p>
    <% } %>
    <% if (!doc.topic && !doc.confidence && !doc.coverage) { %>
    <p class="text-muted mb-0"><small>Click to view full document</small></p>
    <% } %>
  </div>
</div>
<% }); %>
<% } %>

<h2>Codebase Documents</h2>
<% if (codebaseDocs.length === 0) { %>
<%- include('empty-state', { icon: 'C', title: 'No codebase documents', action: 'Run /pbr:scan to generate codebase analysis.' }) %>
<% } else { %>
<% codebaseDocs.forEach(function(doc) { %>
<div class="card mb-2">
  <div class="card-header">
    <strong>
      <a href="/research/<%= doc.slug %>"
         hx-get="/research/<%= doc.slug %>"
         hx-target="#main-content"
         hx-push-url="true"><%= doc.title %></a>
    </strong>
    <% if (doc.date) { %><small class="ms-auto text-muted"><%= doc.date %></small><% } %>
  </div>
  <div class="card-body">
    <% if (doc.focus) { %><p><strong>Focus:</strong> <%= doc.focus %></p><% } %>
    <% if (!doc.focus) { %><p class="text-muted mb-0"><small>Click to view full document</small></p><% } %>
  </div>
</div>
<% }); %>
<% } %>
